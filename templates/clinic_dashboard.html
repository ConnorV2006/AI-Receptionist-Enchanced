{% extends "base.html" %}
{% block content %}
<h1>{{ clinic.name }} Dashboard</h1>

{% if admin %}
  <p>Welcome, {{ admin.username }}{% if admin.is_superadmin %} (Super Admin){% endif %}.</p>
{% endif %}

<h2>Recent SMS</h2>
<ul>
  {% for sms in sms_logs %}
    <li>{{ sms.timestamp }} — {{ sms.to_number }}: {{ sms.message_body }}</li>
  {% else %}
    <li>No SMS yet.</li>
  {% endfor %}
</ul>

<h2>Recent Calls</h2>
<ul>
  {% for call in call_logs %}
    <li>{{ call.timestamp }} — {{ call.from_number }} → {{ call.to_number }} ({{ call.status }})</li>
  {% else %}
    <li>No calls yet.</li>
  {% endfor %}
</ul>

<h2>Upcoming Appointments</h2>
<ul>
  {% for appt in appointments %}
    <li>{{ appt.appt_time.strftime("%Y-%m-%d %I:%M %p") }} — {{ appt.patient.full_name }}</li>
  {% else %}
    <li>No appointments scheduled.</li>
  {% endfor %}
</ul>

<h2>Quick Replies</h2>
<ul>
  {% for reply in replies %}
    <li><strong>{{ reply.title }}</strong>: {{ reply.body }}</li>
  {% else %}
    <li>No quick replies defined.</li>
  {% endfor %}
</ul>

{% if admin %}
  <form method="post" action="{{ url_for('send_sms', slug=clinic.slug) }}">
    <h3>Send SMS</h3>
    <label>To:</label><br>
    <input type="text" name="to" placeholder="+1..."><br>
    <label>Message:</label><br>
    <textarea name="message"></textarea><br>
    <button type="submit">Send SMS</button>
  </form>
{% endif %}

{% endblock %}
